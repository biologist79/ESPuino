<!DOCTYPE html><html lang="de"><head><title data-i18n="title">ESPuino-Settings</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" type="image/x-icon" href="/favicon"><link rel="stylesheet" href="https://espuino.de/espuino/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/themes/default/style.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/11.0.2/css/bootstrap-slider.min.css"><script src="https://espuino.de/espuino/js/jquery.min.js"></script><script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script><script src="https://espuino.de/espuino/js/popper.min.js"></script><script src="https://espuino.de/espuino/js/bootstrap.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/jstree.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/11.0.2/bootstrap-slider.min.js"></script><script src="/js/i18next.min.js"></script><script src="/js/i18nextHttpBackend.min.js"></script><script src="/js/loc_i18next.min.js"></script><style type="text/css">.filetree{border:1px solid #000;height:200px;margin:0 0 1em 0;overflow-y:scroll}.slider.slider-horizontal{width:60%;margin-left:1em;margin-right:1em}.slider-handle{height:30px;width:30px;top:-5px}legend.scheduler-border{width:inherit;padding:0 10px;border-bottom:none}.icon-pos{top:.3em;position:relative}.reboot{color:#fff}.reboot:hover{color:orange}.fa-sync:hover{color:#666}.clickForRefresh{text-align:center;color:gray;cursor:pointer;margin-top:5em}.clickForRefresh:hover{color:#a9a9a9}.filetree-container{position:relative}.coverimage-container{width:80%;height:15%;margin-left:1em;margin-right:1em}.indexing-progress{width:100%;height:100%;position:absolute;top:0;left:0;opacity:.7;display:none}.refreshAction{text-align:right;font-size:.8em}.refreshAction:hover{cursor:pointer;color:#a9a9a9}.overlay{z-index:9;opacity:.8;background:#1a1919;height:200px;display:none;width:100%}#SubTabContent.tab-content{display:flex}#SubTabContent.tab-content>.tab-pane{display:block;visibility:hidden;margin-right:-100%;width:100%}#SubTabContent.tab-content>.active{visibility:visible}select{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAAAAADhgtq/AAAACXBIWXMAAC4jAAAuIwF4pT92AAAAR0lEQVR4nGP5z4ADsOCSGOoyC+NRabjMQqjQQrgUTCYeIrQQyEI3DSyFJIHkApAUkgSy21B0oLo6fiGSBKp/kCUGU4hSRQYAYg0Rw+gGlUQAAAAASUVORK5CYII=) no-repeat;background-position:center right}.fas{padding-right:.25em}</style></head><body><nav class="navbar navbar-expand-sm bg-primary navbar-dark"><div class="col-md-12"><a class="float-left navbar-brand"><img src="/logo" width="35" height="35" class="d-inline-block align-top" alt=""> ESPuino</a><a class="reboot float-right nav-link" href="/restart"><i class="fas fa-redo"></i><span data-i18n="restart">Restart</span></a><a class="reboot float-right nav-link" href="/shutdown"><i class="fas fa-power-off"></i><span data-i18n="shutdown">Shutdown</span></a><a class="reboot float-right nav-link" href="/log"><i class="fas fa-book"></i><span data-i18n="log">Log</span></a><a class="reboot float-right nav-link" href="/info"><i class="fas fa-info"></i><span data-i18n="info">Infos</span></a><select class="form-control float-right" style="width:auto;padding-right:25px" id="langSel" name="langSel"><option value="de">de</option><option value="en">en</option></select></div></nav><br><nav><div class="container nav nav-tabs" id="nav-tab" role="tablist"><a class="nav-item nav-link" id="nav-control-tab" data-toggle="tab" href="#nav-control" role="tab" aria-controls="nav-control" aria-selected="false"><i class="fas fa-gamepad"></i><span class=".d-sm-none .d-md-block" data-i18n="nav.control">Control</span></a><a class="nav-item nav-link active" id="nav-rfid-tab" data-toggle="tab" href="#nav-rfid" role="tab" aria-controls="nav-rfid" aria-selected="true"><i class="fas fa-dot-circle"></i><span data-i18n="nav.rfid">RFID</span></a><a class="nav-item nav-link" id="nav-wifi-tab" data-toggle="tab" href="#nav-wifi" role="tab" aria-controls="nav-wifi" aria-selected="false"><i class="fas fa-wifi"></i><span class=".d-sm-none .d-md-block"><span data-i18n="nav.wifi">WiFi</span></a>%SHOW_MQTT_TAB% %SHOW_FTP_TAB%<a class="nav-item nav-link" id="nav-general-tab" data-toggle="tab" href="#nav-general" role="tab" aria-controls="nav-general" aria-selected="false"><i class="fas fa-sliders-h"></i><span data-i18n="nav.general">General</span></a><a class="nav-item nav-link" id="nav-tools-tab" data-toggle="tab" href="#nav-tools" role="tab" aria-controls="nav-tools" aria-selected="false"><i class="fas fa-wrench"></i><span data-i18n="nav.tools">Tools</span></a><a class="nav-item nav-link" id="nav-forum-tab" data-toggle="tab" href="#nav-forum" role="tab" aria-controls="nav-forum" aria-selected="false"><i class="fas fa-comment"></i><span class=".d-sm-none .d-md-block"><span data-i18n="nav.forum">Forum</span></span></a></div></nav><br><div class="tab-content" id="nav-tabContent"><div class="tab-pane fade" id="nav-wifi" role="tabpanel" aria-labelledby="nav-wifi-tab"><div class="container" id="wifiConfig"><form action="#wifiConfig" method="POST" onsubmit='return wifiConfig("wifiConfig"),!1'><div class="form-group col-md-12"><legend data-i18n="wifi.title">WiFi-settings</legend><label for="ssid" data-i18n="[prepend]wifi.ssid.title">:</label><input type="text" class="form-control" id="ssid" data-i18n="[placeholder]wifi.ssid.placeholder" name="ssid" required><div class="invalid-feedback" data-i18n="wifi.ssid.validation"></div><label for="pwd" data-i18n="[prepend]wifi.password.title">:</label><input type="password" class="form-control" id="pwd" name="pwd" data-i18n="[placeholder]wifi.password.placeholder" required><label for="hostname" data-i18n="[prepend]wifi.hostname.title">:</label><input type="text" class="form-control" id="hostname" data-i18n="[placeholder]wifi.hostname.placeholder" name="hostname" value="%HOSTNAME%" pattern="^[^-\.]{2,32}" required></div><br><div class="text-center"><button type="reset" class="btn btn-secondary" data-i18n="reset"></button>&nbsp<button type="submit" class="btn btn-primary" data-i18n="submit"></button></div></form></div></div><div class="tab-pane fade" id="nav-control" role="tabpanel" aria-labelledby="nav-control-tab"><div class="container" id="navControl"><div class="form-group col-md-12"><legend data-i18n="control.title"></legend><div class="form-group col-md-12"><img src="/cover" class="coverimage-container" id="coverimg" alt=""></div><div class="buttons"><button type="button" class="btn btn-default btn-lg" id="nav-btn-first" onclick="sendControl(173)" data-i18n="[title]control.first"><span class="fas fa-fast-backward"></span></button><button type="button" class="btn btn-default btn-lg" id="nav-btn-prev" onclick="sendControl(171)" data-i18n="[title]control.prev"><span class="fas fa-backward"></span></button><button type="button" class="btn btn-default btn-lg" id="nav-btn-play" onclick="sendControl(170)" data-i18n="[title]control.playpause"><i id="ico-play-pause" class="fas fa-lg fa-play"></i></button><button type="button" class="btn btn-default btn-lg" id="nav-btn-next" onclick="sendControl(172)" data-i18n="[title]control.forward"><span class="fas fa-forward"></span></button><button type="button" class="btn btn-default btn-lg" id="nav-btn-last" onclick="sendControl(174)" data-i18n="[title]control.last"><span class="fas fa-fast-forward"></span></button></div></div><br><div class="form-group col-md-12"><legend data-i18n="control.volume"></legend><button type="button" class="btn btn-default btn-lg" onclick="sendControl(177)" data-i18n="[title]control.voldown"><span class="fas fa-volume-down"></span></button><input data-provide="slider" type="number" data-slider-min="1" data-slider-max="21" min="1" max="21" class="form-control" id="setVolume" data-slider-value="%CURRENT_VOLUME%" value="%CURRENT_VOLUME%" onchange="sendVolume(this.value)"><button type="button" class="btn btn-default btn-lg" onclick="sendControl(176)" data-i18n="[title]control.volup"><span class="fas fa-volume-up"></span></button></div><br><div class="form-group col-md-12"><legend data-i18n="control.current"></legend><div id="track"></div></div></div></div><div class="tab-pane fade show active" id="nav-rfid" role="tabpanel" aria-labelledby="nav-rfid-tab"><div class="container" id="filetreeContainer"><fieldset><legend data-i18n="files.title">Files</legend><div class="filetree-container"><div id="filebrowser"><div class="filetree demo" id="explorerTree"></div></div><div><form id="explorerUploadForm" method="POST" enctype="multipart/form-data" action="/explorer"><div class="input-group"><span class="form-control" id="uploaded_file_text"></span>&nbsp<span class="input-group-btn"><span class="btn btn-secondary" onclick="let input = $(this).parent().find('input[type=file]')[0]; input.webkitdirectory=false; input.click();" data-i18n="[title]files.files.desc;files.files.title">Files</span>&nbsp<span class="btn btn-secondary" onclick="let input = $(this).parent().find('input[type=file]')[0]; input.webkitdirectory=true; input.click();" data-i18n="[title]files.directory.desc;files.directory.title">Directory</span>&nbsp<span class="btn btn-primary" onclick='$(this).parent().find("input[type=file]").submit()' data-i18n="[title]files.upload.desc;files.upload.title">Upload</span><input name="uploaded_file" id="uploaded_file" onchange='$(this).parent().parent().find(".form-control").html($(this).val().split(/[\\|/]/).pop())' style="display:none" type="file" multiple="multiple"></span></div></form><br><div class="progress"><div id="explorerUploadProgress" class="progress-bar" role="progressbar"></div></div></div><br></div></fieldset></div><div class="container" id="rfidMusicTags"><fieldset><legend data-i18n="files.rfid.title">RFID-Assignments</legend><form action="#rfidMusicTags" method="POST" onsubmit='return rfidAssign("rfidMusicTags"),!1'><div class="form-group col-md-12"><label for="rfidIdMusic" data-i18n="files.rfid.idNumber">RFID-number (12 digits)</label><input type="text" class="form-control" id="rfidIdMusic" maxlength="12" pattern="[0-9]{12}" placeholder="%RFID_TAG_ID%" name="rfidIdMusic" required><br><ul class="nav nav-tabs" id="SubTab" role="tablist"><li class="nav-item"><a class="nav-link active" id="rfid-music-tab" data-toggle="tab" href="#rfidmusic" role="tab"><i class="fas fa-music"></i><span data-i18n="files.rfid.music">Music</span></a></li><li class="nav-item"><a class="nav-link" id="rfid-mod-tab" data-toggle="tab" href="#rfidmod" role="tab"><i class="fas fa-cog"></i><span data-i18n="files.rfid.modification">modification</span></a></li></ul><div class="tab-content" id="SubTabContent"><div class="tab-pane show active" id="rfidmusic" role="tabpanel"><br><label for="fileOrUrl" data-i18n="files.rfid.fileurl.title"></label><input type="text" class="form-control" id="fileOrUrl" maxlength="255" pattern="^[^\^#]+$" name="fileOrUrl" data-i18n="[placeholder]files.rfid.fileurl.placeholder" required><label for="playMode" data-i18n="files.rfid.playmode.title"></label><select class="form-control" id="playMode" name="playMode"><option class="placeholder" disabled="disabled" selected="selected" value="" data-i18n="files.rfid.playmode.mode.0"></option><option class="option-file" value="1" data-i18n="files.rfid.playmode.mode.1"></option><option class="option-file" value="2" data-i18n="files.rfid.playmode.mode.2"></option><option class="option-folder" value="12" data-i18n="files.rfid.playmode.mode.3"></option><option class="option-file-and-folder" value="3" data-i18n="files.rfid.playmode.mode.4"></option><option class="option-file-and-folder" value="4" data-i18n="files.rfid.playmode.mode.5"></option><option class="option-folder" value="5" data-i18n="files.rfid.playmode.mode.6"></option><option class="option-folder" value="6" data-i18n="files.rfid.playmode.mode.7"></option><option class="option-folder" value="7" data-i18n="files.rfid.playmode.mode.8"></option><option class="option-folder" value="9" data-i18n="files.rfid.playmode.mode.9"></option><option class="option-folder" value="13" data-i18n="files.rfid.playmode.mode.10"></option><option class="option-stream" value="8" data-i18n="files.rfid.playmode.mode.11"></option><option class="option-stream" value="11" data-i18n="files.rfid.playmode.mode.12"></option></select></div><div class="tab-pane" id="rfidmod" role="tabpanel"><label for="modId" data-i18n="files.rfid.mod.title"></label><select class="form-control" id="modId" name="modId"><option class="placeholder" disabled="disabled" selected="selected" value="" data-i18n="files.rfid.mod.mods.0"></option><option value="100" data-i18n="files.rfid.mod.mods.1"></option><option value="179" data-i18n="files.rfid.mod.mods.2"></option><option value="101" data-i18n="files.rfid.mod.mods.3"></option><option value="102" data-i18n="files.rfid.mod.mods.4"></option><option value="103" data-i18n="files.rfid.mod.mods.5"></option><option value="104" data-i18n="files.rfid.mod.mods.6"></option><option value="105" data-i18n="files.rfid.mod.mods.7"></option><option value="106" data-i18n="files.rfid.mod.mods.8"></option><option value="107" data-i18n="files.rfid.mod.mods.9"></option><option value="110" data-i18n="files.rfid.mod.mods.10"></option><option value="111" data-i18n="files.rfid.mod.mods.11"></option><option value="120" data-i18n="files.rfid.mod.mods.12"></option><option value="130" data-i18n="files.rfid.mod.mods.13"></option><option value="140" data-i18n="files.rfid.mod.mods.14"></option><option value="150" data-i18n="files.rfid.mod.mods.15"></option><option value="0" data-i18n="files.rfid.mod.mods.16"></option><option value="170" data-i18n="files.rfid.mod.mods.17"></option><option value="171" data-i18n="files.rfid.mod.mods.18"></option><option value="172" data-i18n="files.rfid.mod.mods.19"></option><option value="173" data-i18n="files.rfid.mod.mods.20"></option><option value="174" data-i18n="files.rfid.mod.mods.21"></option><option value="180" data-i18n="files.rfid.mod.mods.22"></option><option value="181" data-i18n="files.rfid.mod.mods.23"></option></select></div></div></div><br><div class="text-center"><button type="reset" class="btn btn-secondary" data-i18n="reset">Reset</button>&nbsp<button type="submit" class="btn btn-primary" data-i18n="submit">Submit</button></div></form></fieldset></div><br></div><div class="tab-pane fade" id="nav-mqtt" role="tabpanel" aria-labelledby="nav-mqtt-tab"><div class="container" id="mqttConfig"><form class="needs-validation" action="#mqttConfig" method="POST" onsubmit='return mqttSettings("mqttConfig"),!1'><div class="form-check col-md-12"><legend data-i18n="mqtt.title"></legend><input class="form-check-input" type="checkbox" value="1" id="mqttEnable" name="mqttEnable" %mqtt_enable%><label class="form-check-label" for="mqttEnable" data-i18n="mqtt.enable"></label></div><div class="form-group my-2 col-md-12"><label for="mqttClientId" data-i18n="[prepend]mqtt.clientId.title">:</label><input type="text" class="form-control" id="mqttClientId" minlength="7" maxlength="%MQTT_CLIENTID_LENGTH%" data-i18n="[placeholder]mqtt.clientId.placeholder" name="mqttClientId" value="%MQTT_CLIENTID%"><label for="mqttServer" data-i18n="[prepend]mqtt.server.title">:</label><input type="text" class="form-control" id="mqttServer" minlength="7" maxlength="%MQTT_SERVER_LENGTH%" data-i18n="[placeholder]mqtt.server.placeholder" name="mqttServer" value="%MQTT_SERVER%"><label for="mqttUser" data-i18n="[prepend]mqtt.user.title">:</label><input type="text" class="form-control" id="mqttUser" maxlength="%MQTT_USER_LENGTH%" data-i18n="[placeholder]mqtt.user.placeholder" name="mqttUser" value="%MQTT_USER%"><label for="mqttPwd" data-i18n="[prepend]mqtt.pwd.title">:</label><input type="password" class="form-control" id="mqttPwd" maxlength="%MQTT_PWD_LENGTH%" data-i18n="[placeholder]mqtt.pwd.placeholder" name="mqttPwd" value="%MQTT_PWD%"><label for="mqttPort" data-i18n="[prepend]mqtt.port.title">:</label><input type="number" class="form-control" id="mqttPort" min="1" max="65535" data-i18n="[placeholder]mqtt.port.placeholder" name="mqttPort" value="%MQTT_PORT%" required></div><br><div class="text-center"><button type="reset" class="btn btn-secondary" data-i18n="reset"></button>&nbsp<button type="submit" class="btn btn-primary" data-i18n="submit"></button></div></form></div></div><div class="tab-pane fade" id="nav-ftp" role="tabpanel" aria-labelledby="nav-ftp-tab"><div class="container" id="ftpConfig"><form action="#ftpConfig" method="POST" onsubmit='return ftpSettings("ftpConfig"),!1'><div class="form-group col-md-12"><legend data-i18n="ftp.title"></legend><label for="ftpUser" data-i18n="[prepend]ftp.user.title">:</label><input type="text" class="form-control" id="ftpUser" maxlength="%FTP_USER_LENGTH%" data-i18n="[placeholder]ftp.user.placeholder" name="ftpUser" value="%FTP_USER%" required><label for="pwd" data-i18n="[prepend]ftp.pwd.title">:</label><input type="password" class="form-control" id="ftpPwd" maxlength="%FTP_PWD_LENGTH%" data-i18n="[placeholder]ftp.pwd.placeholder" name="ftpPwd" value="%FTP_PWD%" required></div><br><div class="text-center"><button type="reset" class="btn btn-secondary" data-i18n="reset"></button>&nbsp<button type="submit" class="btn btn-primary" data-i18n="submit"></button></div></form></div><div class="container" id="ftpStart"><div class="form-group col-md-12"><legend data-i18n="ftp.start.title"></legend><div data-i18n="ftp.start.desc"></div><br><div class="text-center"><button type="button" class="btn btn-primary" onclick="ftpStart()" data-i18n="ftp.start.button"></button></div></div></div></div><div class="tab-pane fade" id="nav-general" role="tabpanel" aria-labelledby="nav-general-tab"><div class="container" id="generalConfig"><form action="#generalConfig" method="POST" onsubmit='return genSettings("generalConfig"),!1'><div class="form-group col-md-12"><fieldset><legend class="w-auto" data-i18n="general.volume.title"></legend><label for="initialVolume" data-i18n="[prepend]general.volume.restart">:</label><div class="text-center"><i class="fas fa-volume-down fa-2x .icon-pos"></i><input data-provide="slider" type="number" data-slider-min="1" data-slider-max="21" min="1" max="21" class="form-control" id="initialVolume" name="initialVolume" data-slider-value="%INIT_VOLUME%" value="%INIT_VOLUME%" required><i class="fas fa-volume-up fa-2x .icon-pos"></i></div><br><label for="maxVolumeSpeaker" data-i18n="[prepend]general.volume.speakerMax">:</label><div class="text-center"><i class="fas fa-volume-down fa-2x .icon-pos"></i><input data-provide="slider" type="number" data-slider-min="1" data-slider-max="21" min="1" max="21" class="form-control" id="maxVolumeSpeaker" name="maxVolumeSpeaker" data-slider-value="%MAX_VOLUME_SPEAKER%" value="%MAX_VOLUME_SPEAKER%" required><i class="fas fa-volume-up fa-2x .icon-pos"></i></div><br><label for="maxVolumeHeadphone" data-i18n="[prepend]general.volume.headphoneMax">:</label><div class="text-center"><i class="fas fa-volume-down fa-2x .icon-pos"></i><input data-provide="slider" type="number" data-slider-min="1" data-slider-max="21" min="1" max="21" class="form-control" id="maxVolumeHeadphone" name="maxVolumeHeadphone" data-slider-value="%MAX_VOLUME_HEADPHONE%" value="%MAX_VOLUME_HEADPHONE%" required><i class="fas fa-volume-up fa-2x .icon-pos"></i></div></fieldset></div><br><div class="form-group col-md-12"><fieldset><legend class="w-auto" data-i18n="general.neopixel.title"></legend><label for="initBrightness" data-i18n="[prepend]general.neopixel.restart">:</label><div class="text-center"><i class="far fa-sun fa-2x .icon-pos"></i><input data-provide="slider" type="number" data-slider-min="0" data-slider-max="254" min="0" max="254" class="form-control" id="initBrightness" name="initBrightness" data-slider-value="%INIT_LED_BRIGHTNESS%" value="%INIT_LED_BRIGHTNESS%" required><i class="fas fa-sun fa-2x .icon-pos"></i></div><label for="nightBrightness" data-i18n="[prepend]general.neopixel.nightmode">:</label><div class="text-center"><i class="far fa-sun fa-2x .icon-pos"></i><input data-provide="slider" type="number" data-slider-min="0" data-slider-max="255" min="0" max="255" class="form-control" id="nightBrightness" name="nightBrightness" data-slider-value="%NIGHT_LED_BRIGHTNESS%" value="%NIGHT_LED_BRIGHTNESS%" required><i class="fas fa-sun fa-2x .icon-pos"></i></div></fieldset></div><br><div class="form-group col-md-12"><fieldset><legend data-i18n="general.sleep.title"></legend><label for="inactivityTime" data-i18n="general.sleep.incativity"></label><div class="text-center"><i class="fas fa-hourglass-start fa-2x .icon-pos"></i><input type="number" data-provide="slider" data-slider-min="0" data-slider-max="30" min="1" max="120" class="form-control" id="inactivityTime" name="inactivityTime" data-slider-value="%MAX_INACTIVITY%" value="%MAX_INACTIVITY%" required><i class="fas fa-hourglass-end fa-2x .icon-pos"></i></div></fieldset></div><br><div class="form-group col-md-12"><fieldset><legend data-i18n="general.battery.title"></legend><div data-i18n="general.battery.desc"></div><br><label for="warningLowVoltage" data-i18n="[prepend]general.battery.lowWarning">:</label><div class="text-center"><i class="fas fa-battery-quarter fa-2x .icon-pos"></i><input data-provide="slider" data-slider-step="0.1" data-slider-min="2.5" data-slider-max="5.0" min="2.5" max="5.0" type="text" class="form-control" id="warningLowVoltage" name="warningLowVoltage" data-slider-value="%WARNING_LOW_VOLTAGE%" value="%WARNING_LOW_VOLTAGE%" pattern="^\d{1,2}(\.\d{1,3})?" required><i class="fas fa-battery-three-quarters fa-2x .icon-pos" fa-2x .icon-pos></i></div><br><label for="voltageIndicatorLow" data-i18n="[prepend]general.battery.lowCritical">:</label><div class="text-center"><i class="fas fa-battery-quarter fa-2x .icon-pos"></i><input data-provide="slider" min="2.5" data-slider-step="0.1" data-slider-min="2.5" data-slider-max="5.0" max="5.0" type="text" class="form-control" id="voltageIndicatorLow" name="voltageIndicatorLow" data-slider-value="%VOLTAGE_INDICATOR_LOW%" value="%VOLTAGE_INDICATOR_LOW%" pattern="^\d{1,2}(\.\d{1,3})?" required><i class="fas fa-battery-three-quarters fa-2x .icon-pos" fa-2x .icon-pos></i></div><br><label for="voltageIndicatorHigh" data-i18n="[prepend]general.battery.high">:</label><div class="text-center"><i class="fas fa-battery-quarter fa-2x .icon-pos"></i><input data-provide="slider" data-slider-step="0.1" data-slider-min="2.0" data-slider-max="5.0" min="2.0" max="5.0" type="text" class="form-control" id="voltageIndicatorHigh" name="voltageIndicatorHigh" data-slider-value="%VOLTAGE_INDICATOR_HIGH%" value="%VOLTAGE_INDICATOR_HIGH%" pattern="^\d{1,2}(\.\d{1,3})?" required><i class="fas fa-battery-three-quarters fa-2x .icon-pos" fa-2x .icon-pos></i></div><br><label for="voltageCheckInterval" data-i18n="[prepend]general.battery.measureInterval">:</label><div class="text-center"><i class="fas fa-hourglass-start fa-2x .icon-pos"></i><input data-provide="slider" data-slider-min="1" data-slider-max="60" type="number" min="1" max="60" class="form-control" id="voltageCheckInterval" data-slider-value="%BATTERY_CHECK_INTERVAL%" name="voltageCheckInterval" value="%BATTERY_CHECK_INTERVAL%" required><i class="fas fa-hourglass-end fa-2x .icon-pos"></i></div></fieldset></div><br><div class="text-center"><button type="reset" class="btn btn-secondary" data-i18n="reset"></button>&nbsp<button type="submit" class="btn btn-primary" data-i18n="submit"></button></div></form></div><br></div><div class="tab-pane fade" id="nav-tools" role="tabpanel" aria-labelledby="nav-tools-tab"><div class="container" id="eraseNvs"><legend data-i18n="tools.nvserase.title"></legend><form action="/rfidnvserase" enctype="multipart/form-data" method="GET"><div class="form-group" data-i18n="[html]tools.nvserase.desc"><p></p></div><button type="submit" class="btn btn-primary" data-i18n="tools.nvserase.button"></button></form></div><br><br><div class="container" id="importNvs"><legend data-i18n="tools.nvsimport.title"></legend><form action="/upload" enctype="multipart/form-data" method="POST"><div class="form-group"><label for="nvsUpload" data-i18n="tools.nvsimport.desc"></label><input type="file" class="form-control-file" id="nvsUpload" name="nvsUpload" accept=".txt"></div><button type="submit" class="btn btn-primary" data-i18n="submit"></button></form></div><br><br><div class="container" id="httpUpdate"><legend data-i18n="tools.fwupdate.title"></legend><form action="/update" enctype="multipart/form-data" method="POST"><div class="form-group"><label for="firmwareUpload" data-i18n="tools.fwupdate.desc"></label><input type="file" class="form-control-file" id="firmwareUpload" name="firmwareUpload" accept=".bin"></div><button type="submit" class="btn btn-primary" data-i18n="submit"></button></form></div></div><br><br><div class="tab-pane fade" id="nav-forum" role="tabpanel" aria-labelledby="nav-forum-tab"><div class="container" id="forum"><legend data-i18n="forum.title"></legend><p data-i18n="[html]forum.desc"></p></div></div></div><script type="text/javascript">var localize,DEBUG=!1,lastIdclicked="",ActiveSubTab="rfid-music-tab",host=$(location).attr("hostname"),language=navigator.language||navigator.userLanguage;function postRendering(e,t){Object.keys(t.instance._model.data).forEach((function(e,n){var a=t.instance.get_node(t.instance._model.data[e]).id.split("/").filter((function(e){return e.trim().length>0})).pop();/\.(mp3|MP3|ogg|wav|WAV|OGG|wma|WMA|acc|ACC|flac|FLAC|m4a|M4A)$/i.test(a)?t.instance.set_type(t.instance._model.data[e],"audio"):/\.(png|PNG|jpg|JPG|jpeg|JPEG|bmp|BMP|gif|GIF)$/i.test(a)?(t.instance.set_type(t.instance._model.data[e],"image"),t.instance.disable_node(t.instance._model.data[e])):"file"==t.instance._model.data[e].type&&t.instance.disable_node(t.instance._model.data[e]),t.instance.rename_node(t.instance._model.data[e],a)}))}$("#SubTab.nav-tabs a").on("shown.bs.tab",(function(e){ActiveSubTab=$(e.target).attr("id"),console.log(ActiveSubTab),document.getElementById("fileOrUrl").required="rfid-music-tab"==ActiveSubTab})),DEBUG&&(host="192.168.178.114"),toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut",preventDuplicates:!0,preventOpenDuplicates:!0},i18next.use(i18nextHttpBackend).init({backend:{loadPath:"/locales/{{lng}}.json"},load:"languageOnly",debug:!0,fallbackLng:"en",returnObjects:!0},((e,t)=>{(localize=locI18next.init(i18next))("body");const n=localStorage.getItem("language");null===n?i18next.changeLanguage(language.split("-")[0]):i18next.changeLanguage(n)})),i18next.on("languageChanged",(e=>{document.querySelector("#langSel").value=e,localize&&localize("body")})),document.querySelector("#langSel").addEventListener("change",(e=>{const t=e.target.value;console.log(t),t!==i18next.language&&(localStorage.setItem("language",t),i18next.changeLanguage(t))}));var lastSelectedNodePath="";function doRest(e,t,n){n.url=e,n.dataType="json",n.contentType="application/json;charset=IBM437",n.scriptCharset="IBM437",n.success=function(e,n,a){t&&t(e)},n.error=function(e,t,n){console.log("AJAX error")},jQuery.ajax(n)}function getData(e,t){doRest(e,t,{method:"GET"})}function deleteData(e,t,n){doRest(e,t,{method:"DELETE",data:n})}function patchData(e,t,n){doRest(e,t,{method:"PATCH",data:n})}function postData(e,t,n){doRest(e,t,{method:"POST",data:n})}function putData(e,t,n){doRest(e,t,{method:"PUT",data:n})}function handleDeleteData(e){var t=$("#explorerTree").jstree(!0).get_node(e);console.log("call delete request: "+t.data.path),deleteData("/explorer?path="+encodeURIComponent(t.data.path))}function fileNameSort(e,t){return e.dir&&!t.dir?-1:!e.dir&&t.dir?1:e.name<t.name?-1:e.name>t.name?1:0}function createChild(e,t){var n=$("#explorerTree").jstree(!0).get_node(e).data.path;return"/"==n&&(n=""),{text:t.name,type:getType(t),data:{path:n+"/"+t.name,directory:t.dir}}}function deleteChildrenNodes(e){for(var t=$("#explorerTree").jstree(!0),n=$("#explorerTree").jstree("get_children_dom",e),a=0;a<n.length;a++)t.delete_node(n[a].id)}function refreshNode(e){var t=$("#explorerTree").jstree(!0),n=t.get_node(e);getData("/explorer?path="+encodeURIComponent(n.data.path),(function(n){deleteChildrenNodes(e),addFileDirectory(e,n),t.open_node(e)}))}function getType(e){return e.dir?"folder":/\.(mp3|MP3|ogg|wav|WAV|OGG|wma|WMA|acc|ACC|m4a|M4A|flac|FLAC)$/i.test(e.name)?"audio":/\.(png|PNG|jpg|JPG|jpeg|JPEG|bmp|BMP|gif|GIF)$/i.test(e.name)?"image":"file"}function addFileDirectory(e,t){t.sort(fileNameSort);for(var n=$("#explorerTree").jstree(!0),a=0;a<t.length;a++)console.log("Create Node"),n.create_node(e,createChild(e,t[a]))}function buildFileSystemTree(e){$("#explorerTree").jstree({core:{check_callback:!0,force_text:!0,strings:{"Loading ...":()=>i18next.t("files.loading")},themes:{stripes:!0},data:{text:"/",state:{opened:!0},type:"folder",children:[],data:{path:"/",directory:!0}}},types:{folder:{icon:"fa fa-folder"},file:{icon:"fa fa-file"},audio:{icon:"fa fa-file-audio"},image:{icon:"fa fa-file-image"},default:{icon:"fa fa-folder"}},plugins:["contextmenu","themes","types"],contextmenu:{items:function(e){var t=$("#explorerTree").jstree(!0),n=t.get_node(e),a={};return n.data.directory&&(a.createDir={label:()=>i18next.t("files.context.newFolder"),action:function(a){var o=t.create_node(e,{text:()=>i18next.t("files.context.newFolder"),type:"folder"});o&&t.edit(o,null,(function(t,a){putData("/explorer?path="+encodeURIComponent(n.data.path)+"/"+encodeURIComponent(t.text)),refreshNode(e)}))}}),a.play={label:()=>i18next.t("files.context.play"),action:function(e){var t=1;n.data.directory?t=5:/\.(m3u|M3U)$/i.test(n.data.path)&&(t=11),postData("/exploreraudio?path="+encodeURIComponent(n.data.path)+"&playmode="+t)}},a.refresh={label:()=>i18next.t("files.context.refresh"),action:function(t){refreshNode(e)}},a.delete={label:()=>i18next.t("files.context.delete"),action:function(n){handleDeleteData(e),refreshNode(t.get_parent(e))}},a.rename={label:()=>i18next.t("files.context.rename"),action:function(a){var o=n.data.path;t.edit(e,null,(function(n,a){n.data.path=n.data.path.substring(0,n.data.path.lastIndexOf("/")+1)+n.text,patchData("/explorer?srcpath="+encodeURIComponent(o)+"&dstpath="+encodeURIComponent(n.data.path)),refreshNode(t.get_parent(e))}))}},n.data.directory||(a.download={label:()=>i18next.t("files.context.download"),action:function(e){uri="/explorerdownload?path="+encodeURIComponent(n.data.path),console.log("download file: "+n.data.path);var t=document.createElement("a");t.href=uri,t.target="_blank",t.download=n.data.path,t.click(),document.body.removeChild(document.body.lastElementChild)}}),a}}}),0!=e.length&&getData("/explorer?path=/",(function(e){$("#explorerTree").jstree(!0).settings.core.data.children=[],e.sort(fileNameSort);for(var t=0;t<e.length;t++){var n={text:e[t].name,type:getType(e[t]),data:{path:"/"+e[t].name,directory:e[t].dir},children:[]};$("#explorerTree").jstree(!0).settings.core.data.children.push(n)}$("#explorerTree").jstree(!0).refresh()}))}$("#explorerTree").on("select_node.jstree",(function(e,t){if($("input[name=fileOrUrl]").val(t.node.data.path),"rfid-music-tab"!==ActiveSubTab&&$('#SubTab.nav-tabs a[id="rfid-music-tab"]').tab("show"),"folder"==t.node.type&&($(".option-folder").show(),$(".option-file").hide(),$("#playMode option").removeAttr("selected").filter("[value=3]").attr("selected",!0)),"audio"==t.node.type&&($(".option-file").show(),$(".option-folder").hide(),$("#playMode option").removeAttr("selected").filter("[value=1]").attr("selected",!0)),lastSelectedNodePath!=t.node.data.path){if(t.node.data.directory){var n=$("#explorerTree").jstree(!0).get_selected();if(!n.length)return!1;n=n[0],$("#explorerTree").jstree("get_children_dom",n).length<1&&refreshNode(n)}lastSelectedNodePath=t.node.data.path}})),$("#explorerUploadForm").submit((function(e){e.preventDefault(),console.log("Upload!");var t=new FormData(this),n=$("#explorerTree").jstree(!0),a=n.get_selected(),o="/";return a.length?!document.getElementById("uploaded_file").files.length>0?(alert(i18next.t("files.upload.selectFile")),!1):(a=a[0],selectedNode=n.get_node(a),selectedNode.data.directory?o=selectedNode.data.path:(a=n.get_node(n.get_parent(a)),o=parentNode.data.path,console.log("Parent path: "+o)),void $.ajax({url:"/explorer?path="+o,type:"POST",data:t,contentType:!1,processData:!1,xhr:function(){(new Date).getTime();startTime=(new Date).getTime();bytesTotal=0;var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var t=(new Date).getTime();bytesTotal=e.total;var n=e.loaded/e.total;n=parseInt(100*n),kbytes=e.loaded/1024;kbytes;elapsed_total=(t-startTime)/1e3;kbytes,t;var a=(t-startTime)/1e3,o=a?e.loaded/a:0,d=o/1024,r=e.total-e.loaded,i=a?r/o:"is being calculated..",l=n+"%";console.log("Percent: "+l+", "+d.toFixed(2)+" KB/s");var s=l;i>60?s=s+", "+(i/60).toFixed(0)+" mins. remaining..":i<=0?s=s+" ("+d.toFixed(2)+" KB/s)":i<2?s+=", few secs. remaining..":s=s+", "+i.toFixed(0)+" secs. remaining..",$("#explorerUploadProgress").css("width",l).text(s)}}),!1),e},success:function(e,t,d){var r=((new Date).getTime()-startTime)/1e3,i=(r?bytesTotal/r:0)/1024,l=Math.floor(r/60),s=r-60*l,c=l.toString().padStart(2,"0")+":"+s.toFixed(0).toString().padStart(2,"0");console.log("Upload success ("+c+", "+i.toFixed(2)+" KB/s): "+t);var u=i18next.t("files.upload.success")+" ("+c+", "+i.toFixed(2)+"  KB/s).";$("#explorerUploadProgress").text(u),document.getElementById("uploaded_file").value="",document.getElementById("uploaded_file_text").innerHTML="",getData("/explorer?path="+o,(function(e){deleteChildrenNodes(a),addFileDirectory(a,e),n.open_node(a)}))},error:function(e,t,n){console.log("Upload ERROR!"),$("#explorerUploadProgress").text(i18next.t("files.upload.error")+" :"+t),toastr.error(i18next.t("files.upload.error")+t)}})):(alert(i18next.t("files.upload.selectFolder")),!1)}));var tm,socket=void 0,volumeSlider=new Slider("#setVolume");function connect(){(socket=new WebSocket("ws://"+host+"/ws")).onopen=function(){setInterval(ping,15e3),getTrack(),getCoverimage()},socket.onclose=function(e){console.log("Socket is closed. Reconnect will be attempted in 5 seconds.",e.reason),socket=null,setTimeout((function(){connect()}),5e3)},socket.onerror=function(e){console.error("Socket encountered error: ",e.message,"Closing socket")},socket.onmessage=function(e){console.log(e.data);var t=JSON.parse(e.data);if(null!=t.rfidId&&(document.getElementById("rfidIdMusic").value=t.rfidId,toastr.info(i18next.t("toast.rfidDetect",{rfidId:t.rfidId})),$("#rfidIdMusic").effect("highlight",{color:"#abf5af"},3e3)),"status"in t&&"ok"==t.status&&toastr.success(i18next.t("toast.success")),"pong"in t&&"pong"==t.pong&&pong(),"volume"in t&&volumeSlider.setValue(parseInt(t.volume)),"trackinfo"in t){document.getElementById("track").innerHTML=t.trackinfo.name;var n=document.getElementById("nav-btn-play");t.trackinfo.pausePlay?n.innerHTML='<i id="ico-play-pause" class="fas fa-lg fa-play"></i>':n.innerHTML='<i id="ico-play-pause" class="fas fa-lg fa-pause"></i>';var a=document.getElementById("nav-btn-first"),o=document.getElementById("nav-btn-prev");t.trackinfo.currentTrackNumber<=1?(a.classList.add("disabled"),o.classList.add("disabled")):(a.classList.remove("disabled"),o.classList.remove("disabled"));var d=document.getElementById("nav-btn-last"),r=document.getElementById("nav-btn-next");t.trackinfo.currentTrackNumber>=t.trackinfo.numberOfTracks?(d.classList.add("disabled"),r.classList.add("disabled")):(d.classList.remove("disabled"),r.classList.remove("disabled"))}"coverimg"in t&&(document.getElementById("coverimg").src="/cover?"+(new Date).getTime())}}function ping(){var e=JSON.stringify({ping:{ping:"ping"}});socket.send(e),tm=setTimeout((function(){toastr.warning(i18next.t("toast.conlost"))}),5e3)}function pong(){clearTimeout(tm)}function getTrack(){var e=JSON.stringify({trackinfo:{trackinfo:"trackinfo"}});socket.send(e)}function getCoverimage(){var e=JSON.stringify({coverimg:{coverimg:"coverimg"}});socket.send(e)}function genSettings(e){lastIdclicked=e;var t={general:{iVol:document.getElementById("initialVolume").value,mVolSpeaker:document.getElementById("maxVolumeSpeaker").value,mVolHeadphone:document.getElementById("maxVolumeHeadphone").value,iBright:document.getElementById("initBrightness").value,nBright:document.getElementById("nightBrightness").value,iTime:document.getElementById("inactivityTime").value,vWarning:document.getElementById("warningLowVoltage").value,vIndLow:document.getElementById("voltageIndicatorLow").value,vIndHi:document.getElementById("voltageIndicatorHigh").value,vInt:document.getElementById("voltageCheckInterval").value}},n=JSON.stringify(t);socket.send(n)}function ftpSettings(e){lastIdclicked=e;var t={ftp:{ftpUser:document.getElementById("ftpUser").value,ftpPwd:document.getElementById("ftpPwd").value}},n=JSON.stringify(t);socket.send(n)}function ftpStart(){var e=JSON.stringify({ftpStatus:{start:1}});socket.send(e)}function mqttSettings(e){lastIdclicked=e;var t={mqtt:{mqttEnable:document.getElementById("mqttEnable").checked?document.getElementById("mqttEnable").value:0,mqttClientId:document.getElementById("mqttClientId").value,mqttServer:document.getElementById("mqttServer").value,mqttUser:document.getElementById("mqttUser").value,mqttPwd:document.getElementById("mqttPwd").value,mqttPort:document.getElementById("mqttPort").value}},n=JSON.stringify(t);socket.send(n)}function removeTrSlash(e){return"/"===e.substr(-1)?e.substr(0,e.length-1):e}function rfidAssign(e){if(lastIdclicked=e,"rfid-music-tab"==ActiveSubTab)var t={rfidAssign:{rfidIdMusic:document.getElementById("rfidIdMusic").value,fileOrUrl:removeTrSlash(document.getElementById("fileOrUrl").value),playMode:document.getElementById("playMode").value}};else t={rfidMod:{rfidIdMod:document.getElementById("rfidIdMusic").value,modId:document.getElementById("modId").value}};var n=JSON.stringify(t);socket.send(n)}function wifiConfig(e){lastIdclicked=e;var t={wifiConfig:{ssid:document.getElementById("ssid").value,pwd:document.getElementById("pwd").value,hostname:document.getElementById("hostname").value}},n=JSON.stringify(t);socket.send(n)}function sendControl(e){var t={controls:{action:e}},n=JSON.stringify(t);socket.send(n)}function sendVolume(e){var t={controls:{set_volume:e}},n=JSON.stringify(t);socket.send(n)}document.getElementById("setVolume").remove(),$(document).ready((function(){connect(),buildFileSystemTree("/"),console.log(parseInt(document.getElementById("warningLowVoltage").value)),$((function(){$('[data-toggle="tooltip"]').tooltip()}))}));</script></body></html>